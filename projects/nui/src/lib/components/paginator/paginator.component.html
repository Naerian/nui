<div aria-live="assertive" aria-atomic="true" class="sr-only">
  {{ ariaLiveMessage() }}
</div>

@if (isLoading()) {
  <div class="nui-paginator__loading" role="status" aria-live="polite">
    <span class="nui-paginator__loading-text">{{ getLoadingText() }}</span>
  </div>
}

@if (hasElementsInArea('top')) {
  <div
    class="nui-paginator__area nui-paginator__area--top"
    [class.nui-paginator__area--single]="getElementsForArea('top').length === 1"
    [class.nui-paginator__area--double]="getElementsForArea('top').length === 2"
    [class.nui-paginator__area--triple]="getElementsForArea('top').length >= 3"
    [ngClass]="getAreaClasses('top')"
  >
    @for (element of getElementsForArea('top'); track element) {
      <ng-container
        [ngTemplateOutlet]="elementRenderer"
        [ngTemplateOutletContext]="{ element: element }"
      ></ng-container>
    }
  </div>
}

<div
  class="nui-paginator__horizontal-areas"
  [ngClass]="'nui-paginator__horizontal-areas--items-' + getLayoutVerticalAlign()"
>
  @if (hasElementsInArea('left')) {
    <div class="nui-paginator__area nui-paginator__area--left" [ngClass]="getAreaClasses('left')">
      @for (element of getElementsForArea('left'); track element) {
        <ng-container
          [ngTemplateOutlet]="elementRenderer"
          [ngTemplateOutletContext]="{ element: element }"
        ></ng-container>
      }
    </div>
  }

  @if (hasElementsInArea('center')) {
    <div
      class="nui-paginator__area nui-paginator__area--center"
      [ngClass]="getAreaClasses('center')"
    >
      <nav
        class="nui-paginator"
        [class.nui-paginator--disabled]="disabled()"
        role="navigation"
        [attr.aria-label]="_translations.paginator.ariaPagination"
      >
        @for (element of getElementsForArea('center'); track element) {
          <ng-container
            [ngTemplateOutlet]="elementRenderer"
            [ngTemplateOutletContext]="{ element: element }"
          ></ng-container>
        }
      </nav>
    </div>
  }

  @if (hasElementsInArea('right')) {
    <div class="nui-paginator__area nui-paginator__area--right" [ngClass]="getAreaClasses('right')">
      @for (element of getElementsForArea('right'); track element) {
        <ng-container
          [ngTemplateOutlet]="elementRenderer"
          [ngTemplateOutletContext]="{ element: element }"
        ></ng-container>
      }
    </div>
  }
</div>

@if (hasElementsInArea('bottom')) {
  <div class="nui-paginator__area nui-paginator__area--bottom" [ngClass]="getAreaClasses('bottom')">
    @for (element of getElementsForArea('bottom'); track element) {
      <ng-container
        [ngTemplateOutlet]="elementRenderer"
        [ngTemplateOutletContext]="{ element: element }"
      ></ng-container>
    }
  </div>
}

<ng-template #elementRenderer let-element="element">
  @switch (element) {
    @case ('itemRange') {
      @if (canShowElement('itemRange')) {
        <div class="nui-paginator__info">
          <span class="nui-paginator__info-text">{{ getItemRangeText() }}</span>
        </div>
      }
    }

    @case ('pageSize') {
      @if (canShowElement('pageSize')) {
        <div class="nui-paginator__page-size">
          <nui-btn-group
            [options]="pageSizeOptionsData()"
            [ngModel]="itemsPerPage().toString()"
            [size]="effectiveSize()"
            [color]="color()"
            [variant]="variant()"
            (valueChange)="onPageSizeChange($event)"
          />
        </div>
      }
    }

    @case ('firstButton') {
      <button
        type="button"
        class="nui-paginator__button"
        [disabled]="disabled() || isFirstPage()"
        (click)="goToFirstPage()"
        [attr.aria-label]="_translations.paginator.firstPage"
        data-paginator-button
      >
        <i [class]="getIcon('first')"></i>
      </button>
    }

    @case ('prevButton') {
      <button
        type="button"
        class="nui-paginator__button"
        [disabled]="disabled() || isFirstPage()"
        (click)="goToPreviousPage()"
        [attr.aria-label]="_translations.paginator.previousPage"
        data-paginator-button
      >
        <i [class]="getIcon('previous')"></i>
      </button>
    }

    @case ('nextButton') {
      <button
        type="button"
        class="nui-paginator__button"
        [disabled]="disabled() || isLastPage()"
        (click)="goToNextPage()"
        [attr.aria-label]="_translations.paginator.nextPage"
        data-paginator-button
      >
        <i [class]="getIcon('next')"></i>
      </button>
    }

    @case ('lastButton') {
      <button
        type="button"
        class="nui-paginator__button"
        [disabled]="disabled() || isLastPage()"
        (click)="goToLastPage()"
        [attr.aria-label]="_translations.paginator.lastPage"
        data-paginator-button
      >
        <i [class]="getIcon('last')"></i>
      </button>
    }

    @case ('pageNumbers') {
      <div class="nui-paginator">
        @for (page of visiblePages(); track $index) {
          @if (isEllipsis(page)) {
            <span class="nui-paginator__ellipsis" role="presentation">
              {{ getEllipsisText($any(page)) }}
            </span>
          } @else {
            <button
              type="button"
              class="nui-paginator__button"
              [class.nui-paginator__button--active]="isPageActive(page)"
              [disabled]="disabled()"
              (click)="goToPage($any(page))"
              [attr.aria-current]="isPageActive(page) ? 'page' : null"
              [attr.aria-pressed]="isPageActive(page)"
              [attr.aria-label]="getPageAriaLabel(page)"
              data-paginator-button
            >
              {{ page }}
            </button>
          }
        }
      </div>
    }

    @case ('pageJump') {
      <div class="nui-paginator__page-jump">
        <input
          type="number"
          class="nui-paginator__page-jump-input"
          [disabled]="disabled()"
          [min]="1"
          [max]="totalPages()"
          [(ngModel)]="pageJumpValue"
          (keydown.enter)="handlePageJump()"
          [placeholder]="currentPage()"
          [attr.aria-label]="_translations.paginator.goToPage"
        />

        <button
          nuiButton
          [disabled]="disabled()"
          [color]="color()"
          [variant]="variant()"
          [size]="effectiveSize()"
          (click)="handlePageJump()"
          [attr.aria-label]="_translations.paginator.go"
          [title]="_translations.paginator.go"
        >
          {{ _translations.paginator.go }}
        </button>
      </div>
    }

    @case ('currentPage') {
      <span class="nui-paginator__current-page">{{ currentPage() }} / {{ totalPages() }}</span>
    }

    @case ('fractionalNumbers') {
      <span class="nui-paginator__fractional-info">{{ getFractionalText() }}</span>
    }

    @case ('infiniteButton') {
      @if (canShowElement('infiniteButton')) {
        <button
          nuiButton
          [color]="color()"
          [loading]="infiniteState().isLoading"
          loadingPosition="start"
          (click)="loadMore()"
        >
          {{ getLoadMoreText() }}
        </button>
      }
    }
  }
</ng-template>
